<link rel='import' href='../helper-functions.html'>
<script>


// to-do make SPARouter propeties not configurable
var SPARouter = (function(superClass) {
  var _routeComponents = [];
  window.addEventListener('popstate', handleListenerBound(handlePopChange, _routeComponents));
  window.addEventListener('load',handleListenerBound(initializeRoutes, _routeComponents));
  return class extends superClass {
    
    connectedCallback() {
      preCacheRoute(this);
      // assume that each component is instantiated in order of DOM tree
      _routeComponents.push(this);
      // console.log(_routeComponents);
    }
    get src() {
      return this.getAttribute('src');
    }
    get pathParsed() {
        var stripSlash = this.path.replace(/^\//g,'');
        var anchor = document.createElement('a');
        anchor.href = window.location.origin+'/'+stripSlash;

      return anchor.pathname;
    }
    fetchOrRender() {
      if ( !this.src ) {
        return Promise.resolve();
      }
      //console.log('fetching',context.src);
      //note: fix so as to not need window.location
      return fetch(`${window.location.origin}/${context.src}`).then(function getText(res) {
        // console.log(res);
        return res.text();
      })
      // .then(function populateDOM(data) {
      //   clearShadowDOM(context);
      //   // console.trace();
      //   // console.log(context);
      //   fillShadowDOM(context,data);
      // }).catch(function error(err){
      //   console.log(err);
      // })
      //console.trace()
    }
  }
})(HTMLElement)

</script>