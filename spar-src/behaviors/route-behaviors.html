<link rel='import' href='../helper/helper-functions.html'>
<script>


// to-do make SPARouter propeties not configurable
var SPARouter = ( function ( superClass ) {
  // an array of all our commponents
  var _routeComponents = new Set();

  window.addEventListener('popstate', handleListenerBound(precheckFetch, _routeComponents));
  window.addEventListener('load',handleListenerBound(loadIndexRoutes, _routeComponents));
  return class extends superClass {
    
    connectedCallback() {
      _routeComponents.add(this);
    }
    disconnectedCallback() {
      _routeComponents.delete(this);
    }
    get src() {
      return this.getAttribute('src');
    }
    get frameId() {
      return this.getAttribute('frame-id');
    }
    get pathParsed() {
        // strips leading forward slashes
        var stripSlash = this.path.replace(/^\//g,'');

        // anchor tag will apply url parsing algorithm to the path
        var anchor = document.createElement('a');
        anchor.href = window.location.origin+'/'+stripSlash;
      return anchor.pathname;
    }

    navigateTo() {
      if(window.location.pathname !== this.pathParsed) {
        window.history.pushState({'_spa_PATH':this.pathParsed},'',this.pathParsed);
        initializeFetching ( this.pathParsed, _routeComponents);
      }
    }
  }
})(HTMLElement)

</script>